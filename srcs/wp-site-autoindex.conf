
server {
	listen 80;

	server_name loclahost;

	return 301 https://$host$request_uri;
}

server {
	listen 443 ssl;
	listen [::]:443 ssl;
	include snippets/self-signed.conf;
	include snippets/ssl-params.conf;
	server_name localhost;
	autoindex on;
	autoindex_localtime on;
	autoindex_exact_size off;
    root /var/www/wordpress;
	index index.php index.html index.htm;

	location /pma {
		alias /usr/share/phpmyadmin/;
		location ~ \.php$ {
			fastcgi_pass unix:/run/php/php7.3-fpm.sock;
			fastcgi_index index.php;
			fastcgi_param SCRIPT_FILENAME $request_filename;
			include fastcgi_params;
			fastcgi_ignore_client_abort off;    
		}
		location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
			access_log    off;
			log_not_found    off;
			expires 1M;
		}
	}

	location / { 
		try_files $uri $uri/ /index.php$args;
	}

	location ~* ^.+.(jpg|jpeg|gif|css|png|js|ico|xml)$ {
		access_log off;
		expires 30d;
	}

	location ~ /\.ht {
		deny all;
	}

	location ~ /(libraries|setup/frames|setup/libs) {
		deny all;
		return 404;
	}

	location ~ \.php$ {
		include /etc/nginx/fastcgi_params;
		fastcgi_pass unix:/run/php/php7.3-fpm.sock;
		fastcgi_index index.php;
		include fastcgi_params;
	}
}